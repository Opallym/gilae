{% extends 'base.html.twig' %}

{% block title %}Gilaë - Conseils{% endblock %}

{% block body %}
  {% if mode_edition|default(false) %}
    <div class="locale-selectorservice">
      <a href="{{ path('admin_conseils', {locale: 'fr'}) }}" class="{{ locale == 'fr' ? 'active' : '' }}">Français</a> | 
      <a href="{{ path('admin_conseils', {locale: 'en'}) }}" class="{{ locale == 'en' ? 'active' : '' }}">English</a>
    </div>
  {% endif %}

  <div class="conseils-ligne">
    <div class="feuille1"></div>
    <h1 class="elegant-underline" {% if mode_edition|default(false) %}contenteditable="true" data-cle="titre"{% endif %}>
      {{ contenus.titre|default('Conseils')|raw }}
    </h1>
    <div class="feuille2"></div>
  </div>

  <div class="conseils-ligne">
    <div class="conseils-ampoule"></div>
  </div>

  <div class="conseils-section">
    <h2 {% if mode_edition|default(false) %}contenteditable="true" data-cle="titre1"{% endif %}>
      {{ contenus.titre1|default('CONSEILS POUR PROPRIÉTAIRES')|raw }}
    </h2>
    <br>
    <p {% if mode_edition|default(false) %}contenteditable="true" data-cle="description"{% endif %}>
      {{ contenus.description|default('Préparez votre logement comme un hôte d’exception.')|raw }}
    </p>
    <p {% if mode_edition|default(false) %}contenteditable="true" data-cle="description1"{% endif %}>
      {{ contenus.description1|default('✔ Soignez chaque détail : literie confortable, propreté irréprochable, décoration apaisante.')|raw }}
    </p>
    <p {% if mode_edition|default(false) %}contenteditable="true" data-cle="description2"{% endif %}>
      {{ contenus.description2|default('✔ Mettez à disposition des essentiels : savon, papier toilette, dosettes de café/thé.')|raw }}
    </p>
    <p {% if mode_edition|default(false) %}contenteditable="true" data-cle="description3"{% endif %}>
      {{ contenus.description3|default('✔ Ajoutez une touche personnelle : un mot de bienvenue, un guide du quartier.')|raw }}
    </p>
  </div>

  <br>

  <div class="conseils-section">
    <h2 {% if mode_edition|default(false) %}contenteditable="true" data-cle="titre2"{% endif %}>
      {{ contenus.titre2|default('TENDANCES AIRBNB & LOCATIONS COURTES DURÉES')|raw }}
    </h2>
    <br>
    <p {% if mode_edition|default(false) %}contenteditable="true" data-cle="description4"{% endif %}>
      {{ contenus.description4|default('Ce que les voyageurs recherchent aujourd’hui :')|raw }}
    </p>
    <p {% if mode_edition|default(false) %}contenteditable="true" data-cle="description5"{% endif %}>
      {{ contenus.description5|default('✔ Expériences locales et authentiques')|raw }}
    </p>
    <p {% if mode_edition|default(false) %}contenteditable="true" data-cle="description6"{% endif %}>
      {{ contenus.description6|default('✔ Connexion internet rapide (télétravail oblige !)')|raw }}
    </p>
    <p {% if mode_edition|default(false) %}contenteditable="true" data-cle="description7"{% endif %}>
      {{ contenus.description7|default('✔ Hébergements bien notés, calmes, écoresponsables')|raw }}
    </p>
    <p {% if mode_edition|default(false) %}contenteditable="true" data-cle="description8"{% endif %}>
      {{ contenus.description8|default('✔ Flexibilité sur les horaires d’arrivée et de départ')|raw }}
    </p>
    <p {% if mode_edition|default(false) %}contenteditable="true" data-cle="description9"{% endif %}>
      {{ contenus.description9|default('✔ Annonce avec photos lumineuses, bien cadrées, sans surcharge')|raw }}
    </p>
  </div>

  <br>

  <div class="conseils-section">
    <h2 {% if mode_edition|default(false) %}contenteditable="true" data-cle="titre3"{% endif %}>
      {{ contenus.titre3|default('CE QU’IL FAUT SAVOIR AVANT DE LOUER')|raw }}
    </h2>
    <br>
    <p {% if mode_edition|default(false) %}contenteditable="true" data-cle="description10"{% endif %}>
      {{ contenus.description10|default('✔ Enregistrement obligatoire auprès de votre mairie (notamment dans les grandes villes)')|raw }}
    </p>
    <p {% if mode_edition|default(false) %}contenteditable="true" data-cle="description11"{% endif %}>
      {{ contenus.description11|default('✔ 120 nuits maximum/an pour les résidences principales (dans les communes concernées)')|raw }}
    </p>
    <p {% if mode_edition|default(false) %}contenteditable="true" data-cle="description12"{% endif %}>
      {{ contenus.description12|default('✔ Revenus à déclarer (régime micro-BIC ou réel simplifié)')|raw }}
    </p>
    <p {% if mode_edition|default(false) %}contenteditable="true" data-cle="description13"{% endif %}>
      {{ contenus.description13|default('✔ Respect du règlement de copropriété (silence, animaux, accès communs…)')|raw }}
    </p>
  </div>

  <br>

  <div class="conseils-section">
    <h2 {% if mode_edition|default(false) %}contenteditable="true" data-cle="titre4"{% endif %}>
      {{ contenus.titre4|default('OPTIMISEZ VOTRE LOCATION')|raw }}
    </h2>
    <br>
    <p {% if mode_edition|default(false) %}contenteditable="true" data-cle="description14"{% endif %}>
      {{ contenus.description14|default('✔ Déléguez le ménage et l’accueil pour plus de sérénité')|raw }}
    </p>
    <p {% if mode_edition|default(false) %}contenteditable="true" data-cle="description15"{% endif %}>
      {{ contenus.description15|default('✔ Adaptez vos prix selon la saison et les événements locaux')|raw }}
    </p>
    <p {% if mode_edition|default(false) %}contenteditable="true" data-cle="description16"{% endif %}>
      {{ contenus.description16|default('✔ Restez réactif pour conserver de bonnes évaluations')|raw }}
    </p>
    <p {% if mode_edition|default(false) %}contenteditable="true" data-cle="description17"{% endif %}>
      {{ contenus.description17|default('✔ N’hésitez pas à faire appel à une conciergerie pour alléger votre charge mentale')|raw }}
    </p>
  </div>

  {% if mode_edition|default(false) %}
<div class="btn-containervaliderconseils">
  <button id="btn-validerconseils">Valider les modifications</button>
</div>
<script>
  // Envoi automatique au blur
  document.querySelectorAll('[contenteditable="true"]').forEach(el => {
      el.addEventListener('blur', () => {
          const cle = el.dataset.cle;
          const texte = el.innerText.trim();
          const locale = '{{ locale|default('fr') }}';

          fetch('{{ path("admin_conseils_update") }}', {
              method: 'POST',
              headers: {'Content-Type': 'application/json'},
              body: JSON.stringify({cle: cle, texte: texte, locale: locale})
          })
          .then(response => response.json())
          .then(data => {
              if (!data.success) {
                  alert('Erreur lors de la sauvegarde');
              }
          });
      });
  });

  // Redirection sur bouton valider
  document.getElementById('btn-validerconseils').addEventListener('click', () => {
    window.location.href = '{{ path('admin_gestion') }}';
  });
</script>
{% endif %}
{% endblock %}
